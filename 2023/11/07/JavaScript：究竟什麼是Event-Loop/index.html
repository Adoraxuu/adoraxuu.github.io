<!DOCTYPE html>
<html lang="">
    <head>
    <meta charset="utf-8">

    

    <!-- æ¸²æŸ“ä¼˜åŒ– -->
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="HandheldFriendly" content="True" >
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!--icon-->

    
    
    
    
    


    <!-- meta -->


<title>JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop | Adora&#39;s Blog</title>





    <!-- OpenGraph -->
 
    <meta name="description" content="JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event LoopJavaScript æ˜¯å–®åŸ·è¡Œç·’åˆç¨±ç‚ºå–®ç·šç¨‹ï¼ˆSingle Threadï¼‰çš„è¨­è¨ˆï¼Œå®ƒä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹ä»»å‹™ï¼Œ è€Œã€ŒEvent Loopã€å°±æ˜¯ä½¿JavaScriptèƒ½å¤ è™•ç†å¤šå€‹ä»»å‹™çš„ç§˜è¨£ğŸ’¡ JavaScriptJavaScriptåŒ…å«äº†ï¼šCall Stackï¼ˆå‘¼å«å †ç–Šï¼‰ã€Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰ã€Callback quequ(å›èª¿ä½‡åˆ—)ï¼Œä»¥">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop">
<meta property="og:url" content="http://yoursite.com/2023/11/07/JavaScript%EF%BC%9A%E7%A9%B6%E7%AB%9F%E4%BB%80%E9%BA%BC%E6%98%AFEvent-Loop/index.html">
<meta property="og:site_name" content="Adora&#39;s Blog">
<meta property="og:description" content="JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event LoopJavaScript æ˜¯å–®åŸ·è¡Œç·’åˆç¨±ç‚ºå–®ç·šç¨‹ï¼ˆSingle Threadï¼‰çš„è¨­è¨ˆï¼Œå®ƒä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹ä»»å‹™ï¼Œ è€Œã€ŒEvent Loopã€å°±æ˜¯ä½¿JavaScriptèƒ½å¤ è™•ç†å¤šå€‹ä»»å‹™çš„ç§˜è¨£ğŸ’¡ JavaScriptJavaScriptåŒ…å«äº†ï¼šCall Stackï¼ˆå‘¼å«å †ç–Šï¼‰ã€Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰ã€Callback quequ(å›èª¿ä½‡åˆ—)ï¼Œä»¥">
<meta property="og:locale">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/callstack.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/webapis.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/eventque.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/eventloop.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/pasted-0.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/pasted-0.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/pasted-0.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/pasted-0.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/callstack.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/webapis.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/eventque.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/eventloop.png">
<meta property="og:image" content="http://yoursite.com/images/eventLoop/pasted-0.png">
<meta property="article:published_time" content="2023-11-07T09:38:28.000Z">
<meta property="article:modified_time" content="2023-11-07T10:08:45.403Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://yoursite.com/images/eventLoop/callstack.png">


    
<link rel="stylesheet" href="/css/style/main.css">
 

    
    
    
        <link rel="stylesheet" id="hl-default-theme" href="https://cdn.jsdelivr.net/npm/highlight.js@10.1.2/styles/default.min.css" media="none" onload="this.media='all'">
        
    

    

    

     

    <!-- custom head -->

<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Adora's Blog" type="application/atom+xml">
</head>

    <body>
        <div id="app" tabindex="-1">
            <header class="header">
    <div class="header__left">
        <a href="/" class="button">
            <span class="logo__text">Adora&#39;s blog</span>
        </a>
    </div>
    <div class="header__right">
        
            <div class="navbar__menus">
                
                    <a href="/" class="navbar-menu button">Home</a>
                
                    <a href="/tags/" class="navbar-menu button">Tages</a>
                
                    <a href="/archives/" class="navbar-menu button">Archives</a>
                
                    <a href="/about/" class="navbar-menu button">About</a>
                
            </div>
        
        
        

        
        

        
            <a class="dropdown-icon button" id="btn-dropdown" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='24' height='24' fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round"><path fill="currentColor" d="M3.314,4.8h13.372c0.41,0,0.743-0.333,0.743-0.743c0-0.41-0.333-0.743-0.743-0.743H3.314c-0.41,0-0.743,0.333-0.743,0.743C2.571,4.467,2.904,4.8,3.314,4.8z M16.686,15.2H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,15.2,16.686,15.2z M16.686,9.257H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,9.257,16.686,9.257z"></path></svg></a>
            <div class="dropdown-menus" id="dropdown-menus">
                
                    <a href="/" class="dropdown-menu button">Home</a>
                
                    <a href="/tags/" class="dropdown-menu button">Tages</a>
                
                    <a href="/archives/" class="dropdown-menu button">Archives</a>
                
                    <a href="/about/" class="dropdown-menu button">About</a>
                
            </div>
        
    </div>
</header>


            <main class="main">
    

<div class="post-title">
    <h1 class="post-title__text">
        JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop
    </h1>
    <div class="post-title__meta">
        <a href="/archives/2023/11/" class="post-meta__date button">2023-11-07</a>
        
 
        
    
    


 

 
    </div>
</div>



<article class="post content-card">
    <div class="post__header"></div>
    <div class="post__content">
        <h1 id="JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event-Loop"><a href="#JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event-Loop" class="headerlink" title="JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop"></a>JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop</h1><p>JavaScript æ˜¯å–®åŸ·è¡Œç·’åˆç¨±ç‚ºå–®ç·šç¨‹ï¼ˆSingle Threadï¼‰çš„è¨­è¨ˆï¼Œå®ƒä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹ä»»å‹™ï¼Œ è€Œã€ŒEvent Loopã€å°±æ˜¯ä½¿JavaScriptèƒ½å¤ è™•ç†å¤šå€‹ä»»å‹™çš„ç§˜è¨£ğŸ’¡</p>
<h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><p>JavaScriptåŒ…å«äº†ï¼šCall Stackï¼ˆå‘¼å«å †ç–Šï¼‰ã€Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰ã€Callback quequ(å›èª¿ä½‡åˆ—)ï¼Œä»¥ä¸‹æœƒé€æ­¥ä»‹ç´¹ã€‚</p>
<h2 id="Call-Stackå‘¼å«å †ç–Š"><a href="#Call-Stackå‘¼å«å †ç–Š" class="headerlink" title="Call Stackå‘¼å«å †ç–Š"></a>Call Stackå‘¼å«å †ç–Š</h2><h1 id="JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event-Loop-1"><a href="#JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event-Loop-1" class="headerlink" title="JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop"></a>JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop</h1><p>JavaScript æ˜¯å–®åŸ·è¡Œç·’åˆç¨±ç‚ºå–®ç·šç¨‹ï¼ˆSingle Threadï¼‰çš„è¨­è¨ˆï¼Œå®ƒä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹ä»»å‹™ï¼Œ è€Œã€ŒEvent Loopã€å°±æ˜¯ä½¿JavaScriptèƒ½å¤ è™•ç†å¤šå€‹ä»»å‹™çš„ç§˜è¨£ğŸ’¡</p>
<h2 id="JavaScript-1"><a href="#JavaScript-1" class="headerlink" title="JavaScript"></a>JavaScript</h2><p>JavaScriptåŒ…å«äº†ï¼šCall Stackï¼ˆå‘¼å«å †ç–Šï¼‰ã€Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰ã€Callback quequ(å›èª¿ä½‡åˆ—)ï¼Œä»¥ä¸‹æœƒé€æ­¥ä»‹ç´¹ã€‚</p>
<h2 id="Call-Stackå‘¼å«å †ç–Š-1"><a href="#Call-Stackå‘¼å«å †ç–Š-1" class="headerlink" title="Call Stackå‘¼å«å †ç–Š"></a>Call Stackå‘¼å«å †ç–Š</h2><p><img src="/images/eventLoop/callstack.png"></p>
<ul>
<li>å› ç‚ºJavaScriptç‚ºå–®åŸ·è¡Œç·’çš„è¨­è¨ˆï¼Œ<strong>ä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹å‹•ä½œ</strong>ï¼Œå› æ­¤ç­‰å¾…åŸ·è¡Œçš„ä»»å‹™æœƒè¢«æ”¾å…¥Call Stackã€‚</li>
<li>æº–å‚™åŸ·è¡Œçš„ä»»å‹™æœƒåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸‹å¾€ä¸Šå †ç–Šã€‚</li>
<li>åŸ·è¡Œæ™‚ï¼Œä¹Ÿåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸Šå¾€ä¸‹æ‹¿å–ï¼Œä¹Ÿç¨±ç‚ºå…ˆé€²å¾Œå‡ºæ³•ï¼ˆLIFO, Last in First outï¼‰</li>
</ul>
<hr>
<p>ä½†å¦‚æœå‡ºç¾åƒSetTimeout()ã€fetch()ç­‰ç­‰é‹è¡Œæ™‚é–“è¼ƒé•·çš„å‡½æ•¸ï¼Œè©²æ€éº¼è¾¦å‘¢ï¼Ÿé€™å€‹æ™‚å€™Web APIå°±æ´¾ä¸Šç”¨å ´äº†ï¼</p>
<hr>
<h2 id="Web-APIs"><a href="#Web-APIs" class="headerlink" title="Web APIs"></a>Web APIs</h2><p><img src="/images/eventLoop/webapis.png"></p>
<ul>
<li>æ¯ç•¶å‘¼å«éåŒæ­¥å‡½æ•¸æ™‚ï¼Œå®ƒéƒ½æœƒè¢«å‚³é€åˆ°å°æ‡‰çš„ç€è¦½å™¨APIï¼Œè©²APIæœƒç­‰å¾…å®Œæˆå‡½æ•¸å»¶é²çš„æ“ä½œå¾Œå†å‚³å›é€²è¡Œè™•ç†ã€‚ </li>
<li>ä»¥setTimeout()ç‚ºä¾‹ï¼Œç•¶Call StackåŸ·è¡Œæ™‚ï¼ŒsetTimeout()æœƒè¢«å‚³é€åˆ°Web APIï¼Œç­‰å¾…æŒ‡å®šçš„æ™‚é–“å®Œæˆå†å°‡è©²æ“ä½œå‚³å›é€²è¡Œè™•ç†ã€‚</li>
</ul>
<hr>
<p>å¾Web APIç­‰æ™‚é–“è·‘å®Œå¾Œï¼Œå®ƒå°‡æ“ä½œç™¼é€åˆ°å“ªè£¡ï¼Ÿä»–å€‘è¢«ç™¼é€åˆ°<strong>äº‹ä»¶ä½‡åˆ—ï¼ˆEvent queueï¼‰</strong></p>
<hr>
<h2 id="Event-queue-äº‹ä»¶ä½‡åˆ—"><a href="#Event-queue-äº‹ä»¶ä½‡åˆ—" class="headerlink" title="Event queue äº‹ä»¶ä½‡åˆ—"></a>Event queue äº‹ä»¶ä½‡åˆ—</h2><p><img src="/images/eventLoop/eventque.png"></p>
<ul>
<li>Event queue è£¡é¢æ˜¯å¾…åŸ·è¡Œçš„ä»»å‹™ï¼Œå…¶ä¸­æ¯å€‹è¨Šæ¯éƒ½èˆ‡ä¸€å€‹ function ç›¸é—œè¯ã€‚</li>
<li>ç•¶å †ç–Šä¸­æœ‰è¶³å¤ ç©ºé–“æ™‚ï¼Œæœƒå¾Event queue äº‹ä»¶ä½‡åˆ—æ‹¿å–ä¸€å€‹ä»»å‹™é€²è¡Œè™•ç†ï¼Œè™•ç†éç¨‹åŒ…å«äº†å‘¼å«ç›¸é—œè¯çš„ functionã€‚åªæœ‰ç•¶å †ç–Šæ¸…ç©ºæ™‚ï¼Œè©²ä½‡åˆ—æ‰ç®—æ˜¯å®Œæˆè™•ç†ã€‚</li>
</ul>
<hr>
<p>ä¸Šé¢åˆ†åˆ¥ä»‹ç´¹äº†Call Stackã€Web APIsã€Event queueï¼Œæ¥ä¸‹ä¾†å¯ä»¥å°‡ä»–å€‘çµ„èµ·ä¾†äº†ï¼çµ„èµ·ä¾†å¾Œå¯ä»¥æ›´å¥½åœ°ç†è§£Event Loopã€‚</p>
<hr>
<h2 id="Event-Loop-äº‹ä»¶å¾ªç’°"><a href="#Event-Loop-äº‹ä»¶å¾ªç’°" class="headerlink" title="Event Loop äº‹ä»¶å¾ªç’°"></a>Event Loop äº‹ä»¶å¾ªç’°</h2><p><img src="/images/eventLoop/eventloop.png"></p>
<ul>
<li>Event Loop å®ƒä¸æ–·æª¢æŸ¥Call Stackå‘¼å«å †ç–Šæ˜¯å¦ç‚ºç©ºã€‚<ul>
<li>å¦‚æœç‚ºç©ºï¼šå‰‡å¾äº‹ä»¶ä½‡åˆ—Event queueä¸­æ–°å¢å‡½å¼è‡³Call Stackã€‚ </li>
<li>æ–°å¢å‡½å¼è‡³Call Stackçš„æ­¥é©Ÿï¼Œåˆç¨±ç‚ºéåŒæ­¥å›èª¿ï¼ˆasynchronous ï¼‰</li>
<li>å¦‚æœä¸ç‚ºç©ºï¼šè™•ç†Call Stackå…§çš„å‡½æ•¸ã€‚</li>
</ul>
</li>
</ul>
<h2 id="ç¯„ä¾‹ç¤ºæ„"><a href="#ç¯„ä¾‹ç¤ºæ„" class="headerlink" title="ç¯„ä¾‹ç¤ºæ„"></a>ç¯„ä¾‹ç¤ºæ„</h2><p>ç•¶ç„¶ï¼Œå¦‚æœåƒ…ä»¥ä¸Šä»‹ç´¹ï¼Œç„¡æ³•å®Œæ•´äº†è§£ï¼Œ<br>é€™ç­æº–å‚™äº†å¹¾å€‹ç¨‹å¼ç¢¼åŠæ­é…<a target="_blank" rel="noopener" href="http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4=">loupe</a>ï¼Œè®“è®€è€…èƒ½å¤ æ›´äº†è§£å…¶é‹è¡Œæ­¥é©Ÿ</p>
<p>:warning:å¯ä»¥æŒ‰æ­¤<a target="_blank" rel="noopener" href="http://latentflip.com/loupe/?code=Y29uc29sZS5sb2coIkhpIik7CnNldFRpbWVvdXQoZnVuY3Rpb24gY2IoKSB7CiAgY29uc29sZS5sb2coInRoZXJlIik7Cn0sIDUwMDApOwpjb25zb2xlLmxvZygiZW5kIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4=">loupe</a>äº†è§£JavaScripté‹è¡Œä»¥ä¸Šç¨‹å¼çš„æ­¥é©Ÿ</p>
<h3 id="ç¯„ä¾‹ç¤ºç¯„1"><a href="#ç¯„ä¾‹ç¤ºç¯„1" class="headerlink" title="ç¯„ä¾‹ç¤ºç¯„1"></a>ç¯„ä¾‹ç¤ºç¯„1</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hi&quot;</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">cb</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;there&quot;</span>);<br>&#125;, <span class="hljs-number">5000</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;end&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">Hi<br><span class="hljs-keyword">end</span><br>there<br></code></pre></td></tr></table></figure>

<h3 id="ç¯„ä¾‹ç¤ºç¯„2"><a href="#ç¯„ä¾‹ç¤ºç¯„2" class="headerlink" title="ç¯„ä¾‹ç¤ºç¯„2"></a>ç¯„ä¾‹ç¤ºç¯„2</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">foo</span>();<br>&#125;<br><br><span class="hljs-title function_">foo</span>();<br></code></pre></td></tr></table></figure>
<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<p><img src="/images/eventLoop/pasted-0.png" alt="upload successful"></p>
<p>æ­¤åˆç¨±ç‚º<strong>å †ç–Šçˆ†ç‚¸</strong>ï¼Œç•¶ Stack ä¸æ–·å¢é•·ï¼Œç›´åˆ°ç€è¦½å™¨å…§å­˜è€—ç›¡ã€‚<br>æ˜¯ç€è¦½å™¨åœ¨å“€åšçš„è²éŸ³ğŸ˜‚ğŸ˜‚</p>
<p>ä»¥ä¸Šæ˜¯é—œæ–¼Event Loopçš„ä»‹ç´¹ï¼Œæ˜¯æˆ‘ç”±ä»¥ä¸‹åƒè€ƒè³‡æ–™æ•´ç†+è‡ªå·±ç¹ªåœ–è€Œæˆï¼Œå¦‚æœæ‚¨æœ‰èˆˆè¶£äº†è§£æ›´å¤šï¼Œè«‹åƒè€ƒï¼š</p>
<h3 id="åƒè€ƒè³‡æ–™ï¼š"><a href="#åƒè€ƒè³‡æ–™ï¼š" class="headerlink" title="åƒè€ƒè³‡æ–™ï¼š"></a>åƒè€ƒè³‡æ–™ï¼š</h3><blockquote>
<p>What the heck is the event loop anyway? | Philip Roberts<br><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=8aGhZQkoFbQ">https://www.youtube.com/watch?v=8aGhZQkoFbQ</a></p>
<p>è«‹èªªæ˜ç€è¦½å™¨ä¸­çš„äº‹ä»¶å¾ªç’° (Event Loop)<br><a target="_blank" rel="noopener" href="https://www.explainthis.io/zh-hant/swe/what-is-event-loop">https://www.explainthis.io/zh-hant/swe/what-is-event-loop</a></p>
<p>What is an event loop in JavaScript?<br><a target="_blank" rel="noopener" href="https://www.educative.io/answers/what-is-an-event-loop-in-javascript">https://www.educative.io/answers/what-is-an-event-loop-in-javascript</a></p>
</blockquote>
<!--

- å› ç‚ºJavaScriptç‚ºå–®åŸ·è¡Œç·’çš„è¨­è¨ˆï¼Œ**ä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹å‹•ä½œ**ï¼Œå› æ­¤ç­‰å¾…åŸ·è¡Œçš„ä»»å‹™æœƒè¢«æ”¾å…¥Call Stackã€‚
- æº–å‚™åŸ·è¡Œçš„ä»»å‹™æœƒåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸‹å¾€ä¸Šå †ç–Šã€‚
- åŸ·è¡Œæ™‚ï¼Œä¹Ÿåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸Šå¾€ä¸‹æ‹¿å–ï¼Œä¹Ÿç¨±ç‚ºå…ˆé€²å¾Œå‡ºæ³•ï¼ˆLIFO, Last in First outï¼‰


---

ä½†å¦‚æœå‡ºç¾åƒSetTimeout()ã€fetch()ç­‰ç­‰é‹è¡Œæ™‚é–“è¼ƒé•·çš„å‡½æ•¸ï¼Œè©²æ€éº¼è¾¦å‘¢ï¼Ÿé€™å€‹æ™‚å€™Web APIå°±æ´¾ä¸Šç”¨å ´äº†ï¼

---

## Web APIs
JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop
===
JavaScript æ˜¯å–®åŸ·è¡Œç·’åˆç¨±ç‚ºå–®ç·šç¨‹ï¼ˆSingle Threadï¼‰çš„è¨­è¨ˆï¼Œå®ƒä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹ä»»å‹™ï¼Œ è€Œã€ŒEvent Loopã€å°±æ˜¯ä½¿JavaScriptèƒ½å¤ è™•ç†å¤šå€‹ä»»å‹™çš„ç§˜è¨£ğŸ’¡


## JavaScript
JavaScriptåŒ…å«äº†ï¼šCall Stackï¼ˆå‘¼å«å †ç–Šï¼‰ã€Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰ã€Callback quequ(å›èª¿ä½‡åˆ—)ï¼Œä»¥ä¸‹æœƒé€æ­¥ä»‹ç´¹ã€‚


## Call Stackå‘¼å«å †ç–Š
![](/images/eventLoop/callstack.png)
- å› ç‚ºJavaScriptç‚ºå–®åŸ·è¡Œç·’çš„è¨­è¨ˆï¼Œ**ä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹å‹•ä½œ**ï¼Œå› æ­¤ç­‰å¾…åŸ·è¡Œçš„ä»»å‹™æœƒè¢«æ”¾å…¥Call Stackã€‚
- æº–å‚™åŸ·è¡Œçš„ä»»å‹™æœƒåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸‹å¾€ä¸Šå †ç–Šã€‚
- åŸ·è¡Œæ™‚ï¼Œä¹Ÿåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸Šå¾€ä¸‹æ‹¿å–ï¼Œä¹Ÿç¨±ç‚ºå…ˆé€²å¾Œå‡ºæ³•ï¼ˆLIFO, Last in First outï¼‰


---

ä½†å¦‚æœå‡ºç¾åƒSetTimeout()ã€fetch()ç­‰ç­‰é‹è¡Œæ™‚é–“è¼ƒé•·çš„å‡½æ•¸ï¼Œè©²æ€éº¼è¾¦å‘¢ï¼Ÿé€™å€‹æ™‚å€™Web APIå°±æ´¾ä¸Šç”¨å ´äº†ï¼

---

## Web APIs
![](/images/eventLoop/webapis.png)

- æ¯ç•¶å‘¼å«éåŒæ­¥å‡½æ•¸æ™‚ï¼Œå®ƒéƒ½æœƒè¢«å‚³é€åˆ°å°æ‡‰çš„ç€è¦½å™¨APIï¼Œè©²APIæœƒç­‰å¾…å®Œæˆå‡½æ•¸å»¶é²çš„æ“ä½œå¾Œå†å‚³å›é€²è¡Œè™•ç†ã€‚ 
- ä»¥setTimeout()ç‚ºä¾‹ï¼Œç•¶Call StackåŸ·è¡Œæ™‚ï¼ŒsetTimeout()æœƒè¢«å‚³é€åˆ°Web APIï¼Œç­‰å¾…æŒ‡å®šçš„æ™‚é–“å®Œæˆå†å°‡è©²æ“ä½œå‚³å›é€²è¡Œè™•ç†ã€‚

---
å¾Web APIç­‰æ™‚é–“è·‘å®Œå¾Œï¼Œå®ƒå°‡æ“ä½œç™¼é€åˆ°å“ªè£¡ï¼Ÿä»–å€‘è¢«ç™¼é€åˆ°**äº‹ä»¶ä½‡åˆ—ï¼ˆEvent queueï¼‰**

---

## Event queue äº‹ä»¶ä½‡åˆ—

![](/images/eventLoop/eventque.png)

- Event queue è£¡é¢æ˜¯å¾…åŸ·è¡Œçš„ä»»å‹™ï¼Œå…¶ä¸­æ¯å€‹è¨Šæ¯éƒ½èˆ‡ä¸€å€‹ function ç›¸é—œè¯ã€‚
- ç•¶å †ç–Šä¸­æœ‰è¶³å¤ ç©ºé–“æ™‚ï¼Œæœƒå¾Event queue äº‹ä»¶ä½‡åˆ—æ‹¿å–ä¸€å€‹ä»»å‹™é€²è¡Œè™•ç†ï¼Œè™•ç†éç¨‹åŒ…å«äº†å‘¼å«ç›¸é—œè¯çš„ functionã€‚åªæœ‰ç•¶å †ç–Šæ¸…ç©ºæ™‚ï¼Œè©²ä½‡åˆ—æ‰ç®—æ˜¯å®Œæˆè™•ç†ã€‚

---

ä¸Šé¢åˆ†åˆ¥ä»‹ç´¹äº†Call Stackã€Web APIsã€Event queueï¼Œæ¥ä¸‹ä¾†å¯ä»¥å°‡ä»–å€‘çµ„èµ·ä¾†äº†ï¼çµ„èµ·ä¾†å¾Œå¯ä»¥æ›´å¥½åœ°ç†è§£Event Loopã€‚

---


## Event Loop äº‹ä»¶å¾ªç’°
![](/images/eventLoop/eventloop.png)


- Event Loop å®ƒä¸æ–·æª¢æŸ¥Call Stackå‘¼å«å †ç–Šæ˜¯å¦ç‚ºç©ºã€‚
    - å¦‚æœç‚ºç©ºï¼šå‰‡å¾äº‹ä»¶ä½‡åˆ—Event queueä¸­æ–°å¢å‡½å¼è‡³Call Stackã€‚ 
    - æ–°å¢å‡½å¼è‡³Call Stackçš„æ­¥é©Ÿï¼Œåˆç¨±ç‚ºéåŒæ­¥å›èª¿ï¼ˆasynchronous ï¼‰
    - å¦‚æœä¸ç‚ºç©ºï¼šè™•ç†Call Stackå…§çš„å‡½æ•¸ã€‚


## ç¯„ä¾‹ç¤ºæ„
ç•¶ç„¶ï¼Œå¦‚æœåƒ…ä»¥ä¸Šä»‹ç´¹ï¼Œç„¡æ³•å®Œæ•´äº†è§£ï¼Œ
é€™ç­æº–å‚™äº†å¹¾å€‹ç¨‹å¼ç¢¼åŠæ­é…[loupe](http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D)ï¼Œè®“è®€è€…èƒ½å¤ æ›´äº†è§£å…¶é‹è¡Œæ­¥é©Ÿ

:warning:å¯ä»¥æŒ‰æ­¤[loupe](http://latentflip.com/loupe/?code=Y29uc29sZS5sb2coIkhpIik7CnNldFRpbWVvdXQoZnVuY3Rpb24gY2IoKSB7CiAgY29uc29sZS5sb2coInRoZXJlIik7Cn0sIDUwMDApOwpjb25zb2xlLmxvZygiZW5kIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D)äº†è§£JavaScripté‹è¡Œä»¥ä¸Šç¨‹å¼çš„æ­¥é©Ÿ

### ç¯„ä¾‹ç¤ºç¯„1
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hi&quot;</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">cb</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;there&quot;</span>);<br>&#125;, <span class="hljs-number">5000</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;end&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">Hi<br><span class="hljs-keyword">end</span><br>there<br></code></pre></td></tr></table></figure>

<h3 id="ç¯„ä¾‹ç¤ºç¯„2-1"><a href="#ç¯„ä¾‹ç¤ºç¯„2-1" class="headerlink" title="ç¯„ä¾‹ç¤ºç¯„2"></a>ç¯„ä¾‹ç¤ºç¯„2</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">foo</span>();<br>&#125;<br><br><span class="hljs-title function_">foo</span>();<br></code></pre></td></tr></table></figure>
<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<p><img src="/images/eventLoop/pasted-0.png" alt="upload successful"></p>
<p>æ­¤åˆç¨±ç‚º<strong>å †ç–Šçˆ†ç‚¸</strong>ï¼Œç•¶ Stack ä¸æ–·å¢é•·ï¼Œç›´åˆ°ç€è¦½å™¨å…§å­˜è€—ç›¡ã€‚<br>æ˜¯ç€è¦½å™¨åœ¨å“€åšçš„è²éŸ³ğŸ˜‚ğŸ˜‚</p>
<p>ä»¥ä¸Šæ˜¯é—œæ–¼Event Loopçš„ä»‹ç´¹ï¼Œæ˜¯æˆ‘ç”±ä»¥ä¸‹åƒè€ƒè³‡æ–™æ•´ç†+è‡ªå·±ç¹ªåœ–è€Œæˆï¼Œå¦‚æœæ‚¨æœ‰èˆˆè¶£äº†è§£æ›´å¤šï¼Œè«‹åƒè€ƒï¼š</p>
<h3 id="åƒè€ƒè³‡æ–™ï¼š-1"><a href="#åƒè€ƒè³‡æ–™ï¼š-1" class="headerlink" title="åƒè€ƒè³‡æ–™ï¼š"></a>åƒè€ƒè³‡æ–™ï¼š</h3><blockquote>
<p>What the heck is the event loop anyway? | Philip Roberts<br><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=8aGhZQkoFbQ">https://www.youtube.com/watch?v=8aGhZQkoFbQ</a></p>
<p>è«‹èªªæ˜ç€è¦½å™¨ä¸­çš„äº‹ä»¶å¾ªç’° (Event Loop)<br><a target="_blank" rel="noopener" href="https://www.explainthis.io/zh-hant/swe/what-is-event-loop">https://www.explainthis.io/zh-hant/swe/what-is-event-loop</a></p>
<p>What is an event loop in JavaScript?<br><a target="_blank" rel="noopener" href="https://www.educative.io/answers/what-is-an-event-loop-in-javascript">https://www.educative.io/answers/what-is-an-event-loop-in-javascript</a></p>
</blockquote>
<!--


- æ¯ç•¶å‘¼å«éåŒæ­¥å‡½æ•¸æ™‚ï¼Œå®ƒéƒ½æœƒè¢«å‚³é€åˆ°å°æ‡‰çš„ç€è¦½å™¨APIï¼Œè©²APIæœƒç­‰å¾…å®Œæˆå‡½æ•¸å»¶é²çš„æ“ä½œå¾Œå†å‚³å›é€²è¡Œè™•ç†ã€‚ 
- ä»¥setTimeout()ç‚ºä¾‹ï¼Œç•¶Call StackåŸ·è¡Œæ™‚ï¼ŒsetTimeout()æœƒè¢«å‚³é€åˆ°Web APIï¼Œç­‰å¾…æŒ‡å®šçš„æ™‚é–“å®Œæˆå†å°‡è©²æ“ä½œå‚³å›é€²è¡Œè™•ç†ã€‚

---
å¾Web APIç­‰æ™‚é–“è·‘å®Œå¾Œï¼Œå®ƒå°‡æ“ä½œç™¼é€åˆ°å“ªè£¡ï¼Ÿä»–å€‘è¢«ç™¼é€åˆ°**äº‹ä»¶ä½‡åˆ—ï¼ˆEvent queueï¼‰**

---

## Event queue äº‹ä»¶ä½‡åˆ—

JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop
===
JavaScript æ˜¯å–®åŸ·è¡Œç·’åˆç¨±ç‚ºå–®ç·šç¨‹ï¼ˆSingle Threadï¼‰çš„è¨­è¨ˆï¼Œå®ƒä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹ä»»å‹™ï¼Œ è€Œã€ŒEvent Loopã€å°±æ˜¯ä½¿JavaScriptèƒ½å¤ è™•ç†å¤šå€‹ä»»å‹™çš„ç§˜è¨£ğŸ’¡


## JavaScript
JavaScriptåŒ…å«äº†ï¼šCall Stackï¼ˆå‘¼å«å †ç–Šï¼‰ã€Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰ã€Callback quequ(å›èª¿ä½‡åˆ—)ï¼Œä»¥ä¸‹æœƒé€æ­¥ä»‹ç´¹ã€‚


## Call Stackå‘¼å«å †ç–Š
![](/images/eventLoop/callstack.png)
- å› ç‚ºJavaScriptç‚ºå–®åŸ·è¡Œç·’çš„è¨­è¨ˆï¼Œ**ä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹å‹•ä½œ**ï¼Œå› æ­¤ç­‰å¾…åŸ·è¡Œçš„ä»»å‹™æœƒè¢«æ”¾å…¥Call Stackã€‚
- æº–å‚™åŸ·è¡Œçš„ä»»å‹™æœƒåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸‹å¾€ä¸Šå †ç–Šã€‚
- åŸ·è¡Œæ™‚ï¼Œä¹Ÿåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸Šå¾€ä¸‹æ‹¿å–ï¼Œä¹Ÿç¨±ç‚ºå…ˆé€²å¾Œå‡ºæ³•ï¼ˆLIFO, Last in First outï¼‰


---

ä½†å¦‚æœå‡ºç¾åƒSetTimeout()ã€fetch()ç­‰ç­‰é‹è¡Œæ™‚é–“è¼ƒé•·çš„å‡½æ•¸ï¼Œè©²æ€éº¼è¾¦å‘¢ï¼Ÿé€™å€‹æ™‚å€™Web APIå°±æ´¾ä¸Šç”¨å ´äº†ï¼

---

## Web APIs
![](/images/eventLoop/webapis.png)

- æ¯ç•¶å‘¼å«éåŒæ­¥å‡½æ•¸æ™‚ï¼Œå®ƒéƒ½æœƒè¢«å‚³é€åˆ°å°æ‡‰çš„ç€è¦½å™¨APIï¼Œè©²APIæœƒç­‰å¾…å®Œæˆå‡½æ•¸å»¶é²çš„æ“ä½œå¾Œå†å‚³å›é€²è¡Œè™•ç†ã€‚ 
- ä»¥setTimeout()ç‚ºä¾‹ï¼Œç•¶Call StackåŸ·è¡Œæ™‚ï¼ŒsetTimeout()æœƒè¢«å‚³é€åˆ°Web APIï¼Œç­‰å¾…æŒ‡å®šçš„æ™‚é–“å®Œæˆå†å°‡è©²æ“ä½œå‚³å›é€²è¡Œè™•ç†ã€‚

---
å¾Web APIç­‰æ™‚é–“è·‘å®Œå¾Œï¼Œå®ƒå°‡æ“ä½œç™¼é€åˆ°å“ªè£¡ï¼Ÿä»–å€‘è¢«ç™¼é€åˆ°**äº‹ä»¶ä½‡åˆ—ï¼ˆEvent queueï¼‰**

---

## Event queue äº‹ä»¶ä½‡åˆ—

![](/images/eventLoop/eventque.png)

- Event queue è£¡é¢æ˜¯å¾…åŸ·è¡Œçš„ä»»å‹™ï¼Œå…¶ä¸­æ¯å€‹è¨Šæ¯éƒ½èˆ‡ä¸€å€‹ function ç›¸é—œè¯ã€‚
- ç•¶å †ç–Šä¸­æœ‰è¶³å¤ ç©ºé–“æ™‚ï¼Œæœƒå¾Event queue äº‹ä»¶ä½‡åˆ—æ‹¿å–ä¸€å€‹ä»»å‹™é€²è¡Œè™•ç†ï¼Œè™•ç†éç¨‹åŒ…å«äº†å‘¼å«ç›¸é—œè¯çš„ functionã€‚åªæœ‰ç•¶å †ç–Šæ¸…ç©ºæ™‚ï¼Œè©²ä½‡åˆ—æ‰ç®—æ˜¯å®Œæˆè™•ç†ã€‚

---

ä¸Šé¢åˆ†åˆ¥ä»‹ç´¹äº†Call Stackã€Web APIsã€Event queueï¼Œæ¥ä¸‹ä¾†å¯ä»¥å°‡ä»–å€‘çµ„èµ·ä¾†äº†ï¼çµ„èµ·ä¾†å¾Œå¯ä»¥æ›´å¥½åœ°ç†è§£Event Loopã€‚

---


## Event Loop äº‹ä»¶å¾ªç’°
![](/images/eventLoop/eventloop.png)


- Event Loop å®ƒä¸æ–·æª¢æŸ¥Call Stackå‘¼å«å †ç–Šæ˜¯å¦ç‚ºç©ºã€‚
    - å¦‚æœç‚ºç©ºï¼šå‰‡å¾äº‹ä»¶ä½‡åˆ—Event queueä¸­æ–°å¢å‡½å¼è‡³Call Stackã€‚ 
    - æ–°å¢å‡½å¼è‡³Call Stackçš„æ­¥é©Ÿï¼Œåˆç¨±ç‚ºéåŒæ­¥å›èª¿ï¼ˆasynchronous ï¼‰
    - å¦‚æœä¸ç‚ºç©ºï¼šè™•ç†Call Stackå…§çš„å‡½æ•¸ã€‚


## ç¯„ä¾‹ç¤ºæ„
ç•¶ç„¶ï¼Œå¦‚æœåƒ…ä»¥ä¸Šä»‹ç´¹ï¼Œç„¡æ³•å®Œæ•´äº†è§£ï¼Œ
é€™ç­æº–å‚™äº†å¹¾å€‹ç¨‹å¼ç¢¼åŠæ­é…[loupe](http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D)ï¼Œè®“è®€è€…èƒ½å¤ æ›´äº†è§£å…¶é‹è¡Œæ­¥é©Ÿ

:warning:å¯ä»¥æŒ‰æ­¤[loupe](http://latentflip.com/loupe/?code=Y29uc29sZS5sb2coIkhpIik7CnNldFRpbWVvdXQoZnVuY3Rpb24gY2IoKSB7CiAgY29uc29sZS5sb2coInRoZXJlIik7Cn0sIDUwMDApOwpjb25zb2xlLmxvZygiZW5kIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D)äº†è§£JavaScripté‹è¡Œä»¥ä¸Šç¨‹å¼çš„æ­¥é©Ÿ

### ç¯„ä¾‹ç¤ºç¯„1
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hi&quot;</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">cb</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;there&quot;</span>);<br>&#125;, <span class="hljs-number">5000</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;end&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">Hi<br><span class="hljs-keyword">end</span><br>there<br></code></pre></td></tr></table></figure>

<h3 id="ç¯„ä¾‹ç¤ºç¯„2-2"><a href="#ç¯„ä¾‹ç¤ºç¯„2-2" class="headerlink" title="ç¯„ä¾‹ç¤ºç¯„2"></a>ç¯„ä¾‹ç¤ºç¯„2</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">foo</span>();<br>&#125;<br><br><span class="hljs-title function_">foo</span>();<br></code></pre></td></tr></table></figure>
<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<p><img src="/images/eventLoop/pasted-0.png" alt="upload successful"></p>
<p>æ­¤åˆç¨±ç‚º<strong>å †ç–Šçˆ†ç‚¸</strong>ï¼Œç•¶ Stack ä¸æ–·å¢é•·ï¼Œç›´åˆ°ç€è¦½å™¨å…§å­˜è€—ç›¡ã€‚<br>æ˜¯ç€è¦½å™¨åœ¨å“€åšçš„è²éŸ³ğŸ˜‚ğŸ˜‚</p>
<p>ä»¥ä¸Šæ˜¯é—œæ–¼Event Loopçš„ä»‹ç´¹ï¼Œæ˜¯æˆ‘ç”±ä»¥ä¸‹åƒè€ƒè³‡æ–™æ•´ç†+è‡ªå·±ç¹ªåœ–è€Œæˆï¼Œå¦‚æœæ‚¨æœ‰èˆˆè¶£äº†è§£æ›´å¤šï¼Œè«‹åƒè€ƒï¼š</p>
<h3 id="åƒè€ƒè³‡æ–™ï¼š-2"><a href="#åƒè€ƒè³‡æ–™ï¼š-2" class="headerlink" title="åƒè€ƒè³‡æ–™ï¼š"></a>åƒè€ƒè³‡æ–™ï¼š</h3><blockquote>
<p>What the heck is the event loop anyway? | Philip Roberts<br><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=8aGhZQkoFbQ">https://www.youtube.com/watch?v=8aGhZQkoFbQ</a></p>
<p>è«‹èªªæ˜ç€è¦½å™¨ä¸­çš„äº‹ä»¶å¾ªç’° (Event Loop)<br><a target="_blank" rel="noopener" href="https://www.explainthis.io/zh-hant/swe/what-is-event-loop">https://www.explainthis.io/zh-hant/swe/what-is-event-loop</a></p>
<p>What is an event loop in JavaScript?<br><a target="_blank" rel="noopener" href="https://www.educative.io/answers/what-is-an-event-loop-in-javascript">https://www.educative.io/answers/what-is-an-event-loop-in-javascript</a></p>
</blockquote>
<!--


- Event queue è£¡é¢æ˜¯å¾…åŸ·è¡Œçš„ä»»å‹™ï¼Œå…¶ä¸­æ¯å€‹è¨Šæ¯éƒ½èˆ‡ä¸€å€‹ function ç›¸é—œè¯ã€‚
- ç•¶å †ç–Šä¸­æœ‰è¶³å¤ ç©ºé–“æ™‚ï¼Œæœƒå¾Event queue äº‹ä»¶ä½‡åˆ—æ‹¿å–ä¸€å€‹ä»»å‹™é€²è¡Œè™•ç†ï¼Œè™•ç†éç¨‹åŒ…å«äº†å‘¼å«ç›¸é—œè¯çš„ functionã€‚åªæœ‰ç•¶å †ç–Šæ¸…ç©ºæ™‚ï¼Œè©²ä½‡åˆ—æ‰ç®—æ˜¯å®Œæˆè™•ç†ã€‚

---

ä¸Šé¢åˆ†åˆ¥ä»‹ç´¹äº†Call Stackã€Web APIsã€Event queueï¼Œæ¥ä¸‹ä¾†å¯ä»¥å°‡ä»–å€‘çµ„èµ·ä¾†äº†ï¼çµ„èµ·ä¾†å¾Œå¯ä»¥æ›´å¥½åœ°ç†è§£Event Loopã€‚

---


## Event Loop äº‹ä»¶å¾ªç’°
JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop
===
JavaScript æ˜¯å–®åŸ·è¡Œç·’åˆç¨±ç‚ºå–®ç·šç¨‹ï¼ˆSingle Threadï¼‰çš„è¨­è¨ˆï¼Œå®ƒä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹ä»»å‹™ï¼Œ è€Œã€ŒEvent Loopã€å°±æ˜¯ä½¿JavaScriptèƒ½å¤ è™•ç†å¤šå€‹ä»»å‹™çš„ç§˜è¨£ğŸ’¡


## JavaScript
JavaScriptåŒ…å«äº†ï¼šCall Stackï¼ˆå‘¼å«å †ç–Šï¼‰ã€Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰ã€Callback quequ(å›èª¿ä½‡åˆ—)ï¼Œä»¥ä¸‹æœƒé€æ­¥ä»‹ç´¹ã€‚


## Call Stackå‘¼å«å †ç–Š
![](/images/eventLoop/callstack.png)
- å› ç‚ºJavaScriptç‚ºå–®åŸ·è¡Œç·’çš„è¨­è¨ˆï¼Œ**ä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹å‹•ä½œ**ï¼Œå› æ­¤ç­‰å¾…åŸ·è¡Œçš„ä»»å‹™æœƒè¢«æ”¾å…¥Call Stackã€‚
- æº–å‚™åŸ·è¡Œçš„ä»»å‹™æœƒåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸‹å¾€ä¸Šå †ç–Šã€‚
- åŸ·è¡Œæ™‚ï¼Œä¹Ÿåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸Šå¾€ä¸‹æ‹¿å–ï¼Œä¹Ÿç¨±ç‚ºå…ˆé€²å¾Œå‡ºæ³•ï¼ˆLIFO, Last in First outï¼‰


---

ä½†å¦‚æœå‡ºç¾åƒSetTimeout()ã€fetch()ç­‰ç­‰é‹è¡Œæ™‚é–“è¼ƒé•·çš„å‡½æ•¸ï¼Œè©²æ€éº¼è¾¦å‘¢ï¼Ÿé€™å€‹æ™‚å€™Web APIå°±æ´¾ä¸Šç”¨å ´äº†ï¼

---

## Web APIs
![](/images/eventLoop/webapis.png)

- æ¯ç•¶å‘¼å«éåŒæ­¥å‡½æ•¸æ™‚ï¼Œå®ƒéƒ½æœƒè¢«å‚³é€åˆ°å°æ‡‰çš„ç€è¦½å™¨APIï¼Œè©²APIæœƒç­‰å¾…å®Œæˆå‡½æ•¸å»¶é²çš„æ“ä½œå¾Œå†å‚³å›é€²è¡Œè™•ç†ã€‚ 
- ä»¥setTimeout()ç‚ºä¾‹ï¼Œç•¶Call StackåŸ·è¡Œæ™‚ï¼ŒsetTimeout()æœƒè¢«å‚³é€åˆ°Web APIï¼Œç­‰å¾…æŒ‡å®šçš„æ™‚é–“å®Œæˆå†å°‡è©²æ“ä½œå‚³å›é€²è¡Œè™•ç†ã€‚

---
å¾Web APIç­‰æ™‚é–“è·‘å®Œå¾Œï¼Œå®ƒå°‡æ“ä½œç™¼é€åˆ°å“ªè£¡ï¼Ÿä»–å€‘è¢«ç™¼é€åˆ°**äº‹ä»¶ä½‡åˆ—ï¼ˆEvent queueï¼‰**

---

## Event queue äº‹ä»¶ä½‡åˆ—

![](/images/eventLoop/eventque.png)

- Event queue è£¡é¢æ˜¯å¾…åŸ·è¡Œçš„ä»»å‹™ï¼Œå…¶ä¸­æ¯å€‹è¨Šæ¯éƒ½èˆ‡ä¸€å€‹ function ç›¸é—œè¯ã€‚
- ç•¶å †ç–Šä¸­æœ‰è¶³å¤ ç©ºé–“æ™‚ï¼Œæœƒå¾Event queue äº‹ä»¶ä½‡åˆ—æ‹¿å–ä¸€å€‹ä»»å‹™é€²è¡Œè™•ç†ï¼Œè™•ç†éç¨‹åŒ…å«äº†å‘¼å«ç›¸é—œè¯çš„ functionã€‚åªæœ‰ç•¶å †ç–Šæ¸…ç©ºæ™‚ï¼Œè©²ä½‡åˆ—æ‰ç®—æ˜¯å®Œæˆè™•ç†ã€‚

---

ä¸Šé¢åˆ†åˆ¥ä»‹ç´¹äº†Call Stackã€Web APIsã€Event queueï¼Œæ¥ä¸‹ä¾†å¯ä»¥å°‡ä»–å€‘çµ„èµ·ä¾†äº†ï¼çµ„èµ·ä¾†å¾Œå¯ä»¥æ›´å¥½åœ°ç†è§£Event Loopã€‚

---


## Event Loop äº‹ä»¶å¾ªç’°
![](/images/eventLoop/eventloop.png)


- Event Loop å®ƒä¸æ–·æª¢æŸ¥Call Stackå‘¼å«å †ç–Šæ˜¯å¦ç‚ºç©ºã€‚
    - å¦‚æœç‚ºç©ºï¼šå‰‡å¾äº‹ä»¶ä½‡åˆ—Event queueä¸­æ–°å¢å‡½å¼è‡³Call Stackã€‚ 
    - æ–°å¢å‡½å¼è‡³Call Stackçš„æ­¥é©Ÿï¼Œåˆç¨±ç‚ºéåŒæ­¥å›èª¿ï¼ˆasynchronous ï¼‰
    - å¦‚æœä¸ç‚ºç©ºï¼šè™•ç†Call Stackå…§çš„å‡½æ•¸ã€‚


## ç¯„ä¾‹ç¤ºæ„
ç•¶ç„¶ï¼Œå¦‚æœåƒ…ä»¥ä¸Šä»‹ç´¹ï¼Œç„¡æ³•å®Œæ•´äº†è§£ï¼Œ
é€™ç­æº–å‚™äº†å¹¾å€‹ç¨‹å¼ç¢¼åŠæ­é…[loupe](http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D)ï¼Œè®“è®€è€…èƒ½å¤ æ›´äº†è§£å…¶é‹è¡Œæ­¥é©Ÿ

:warning:å¯ä»¥æŒ‰æ­¤[loupe](http://latentflip.com/loupe/?code=Y29uc29sZS5sb2coIkhpIik7CnNldFRpbWVvdXQoZnVuY3Rpb24gY2IoKSB7CiAgY29uc29sZS5sb2coInRoZXJlIik7Cn0sIDUwMDApOwpjb25zb2xlLmxvZygiZW5kIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D)äº†è§£JavaScripté‹è¡Œä»¥ä¸Šç¨‹å¼çš„æ­¥é©Ÿ

### ç¯„ä¾‹ç¤ºç¯„1
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hi&quot;</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">cb</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;there&quot;</span>);<br>&#125;, <span class="hljs-number">5000</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;end&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">Hi<br><span class="hljs-keyword">end</span><br>there<br></code></pre></td></tr></table></figure>

<h3 id="ç¯„ä¾‹ç¤ºç¯„2-3"><a href="#ç¯„ä¾‹ç¤ºç¯„2-3" class="headerlink" title="ç¯„ä¾‹ç¤ºç¯„2"></a>ç¯„ä¾‹ç¤ºç¯„2</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">foo</span>();<br>&#125;<br><br><span class="hljs-title function_">foo</span>();<br></code></pre></td></tr></table></figure>
<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<p><img src="/images/eventLoop/pasted-0.png" alt="upload successful"></p>
<p>æ­¤åˆç¨±ç‚º<strong>å †ç–Šçˆ†ç‚¸</strong>ï¼Œç•¶ Stack ä¸æ–·å¢é•·ï¼Œç›´åˆ°ç€è¦½å™¨å…§å­˜è€—ç›¡ã€‚<br>æ˜¯ç€è¦½å™¨åœ¨å“€åšçš„è²éŸ³ğŸ˜‚ğŸ˜‚</p>
<p>ä»¥ä¸Šæ˜¯é—œæ–¼Event Loopçš„ä»‹ç´¹ï¼Œæ˜¯æˆ‘ç”±ä»¥ä¸‹åƒè€ƒè³‡æ–™æ•´ç†+è‡ªå·±ç¹ªåœ–è€Œæˆï¼Œå¦‚æœæ‚¨æœ‰èˆˆè¶£äº†è§£æ›´å¤šï¼Œè«‹åƒè€ƒï¼š</p>
<h3 id="åƒè€ƒè³‡æ–™ï¼š-3"><a href="#åƒè€ƒè³‡æ–™ï¼š-3" class="headerlink" title="åƒè€ƒè³‡æ–™ï¼š"></a>åƒè€ƒè³‡æ–™ï¼š</h3><blockquote>
<p>What the heck is the event loop anyway? | Philip Roberts<br><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=8aGhZQkoFbQ">https://www.youtube.com/watch?v=8aGhZQkoFbQ</a></p>
<p>è«‹èªªæ˜ç€è¦½å™¨ä¸­çš„äº‹ä»¶å¾ªç’° (Event Loop)<br><a target="_blank" rel="noopener" href="https://www.explainthis.io/zh-hant/swe/what-is-event-loop">https://www.explainthis.io/zh-hant/swe/what-is-event-loop</a></p>
<p>What is an event loop in JavaScript?<br><a target="_blank" rel="noopener" href="https://www.educative.io/answers/what-is-an-event-loop-in-javascript">https://www.educative.io/answers/what-is-an-event-loop-in-javascript</a></p>
</blockquote>
<!--



- Event Loop å®ƒä¸æ–·æª¢æŸ¥Call Stackå‘¼å«å †ç–Šæ˜¯å¦ç‚ºç©ºã€‚
    - å¦‚æœç‚ºç©ºï¼šå‰‡å¾äº‹ä»¶ä½‡åˆ—Event queueä¸­æ–°å¢å‡½å¼è‡³Call Stackã€‚ 
    - æ–°å¢å‡½å¼è‡³Call Stackçš„æ­¥é©Ÿï¼Œåˆç¨±ç‚ºéåŒæ­¥å›èª¿ï¼ˆasynchronous ï¼‰
    - å¦‚æœä¸ç‚ºç©ºï¼šè™•ç†Call Stackå…§çš„å‡½æ•¸ã€‚


## ç¯„ä¾‹ç¤ºæ„
ç•¶ç„¶ï¼Œå¦‚æœåƒ…ä»¥ä¸Šä»‹ç´¹ï¼Œç„¡æ³•å®Œæ•´äº†è§£ï¼Œ
é€™ç­æº–å‚™äº†å¹¾å€‹ç¨‹å¼ç¢¼åŠæ­é…[loupe](http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D)ï¼Œè®“è®€è€…èƒ½å¤ æ›´äº†è§£å…¶é‹è¡Œæ­¥é©Ÿ

:warning:å¯ä»¥æŒ‰æ­¤[loupe](http://latentflip.com/loupe/?code=Y29uc29sZS5sb2coIkhpIik7CnNldFRpbWVvdXQoZnVuY3Rpb24gY2IoKSB7CiAgY29uc29sZS5sb2coInRoZXJlIik7Cn0sIDUwMDApOwpjb25zb2xlLmxvZygiZW5kIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D)äº†è§£JavaScripté‹è¡Œä»¥ä¸Šç¨‹å¼çš„æ­¥é©Ÿ

### ç¯„ä¾‹ç¤ºç¯„1
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hi&quot;</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">cb</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;there&quot;</span>);<br>&#125;, <span class="hljs-number">5000</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;end&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">Hi<br><span class="hljs-keyword">end</span><br>there<br></code></pre></td></tr></table></figure>

<h3 id="ç¯„ä¾‹ç¤ºç¯„2-4"><a href="#ç¯„ä¾‹ç¤ºç¯„2-4" class="headerlink" title="ç¯„ä¾‹ç¤ºç¯„2"></a>ç¯„ä¾‹ç¤ºç¯„2</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">foo</span>();<br>&#125;<br><br><span class="hljs-title function_">foo</span>();<br></code></pre></td></tr></table></figure>
<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<h1 id="JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event-Loop-2"><a href="#JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event-Loop-2" class="headerlink" title="JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop"></a>JavaScriptï¼šç©¶ç«Ÿä»€éº¼æ˜¯Event Loop</h1><p>JavaScript æ˜¯å–®åŸ·è¡Œç·’åˆç¨±ç‚ºå–®ç·šç¨‹ï¼ˆSingle Threadï¼‰çš„è¨­è¨ˆï¼Œå®ƒä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹ä»»å‹™ï¼Œ è€Œã€ŒEvent Loopã€å°±æ˜¯ä½¿JavaScriptèƒ½å¤ è™•ç†å¤šå€‹ä»»å‹™çš„ç§˜è¨£ğŸ’¡</p>
<h2 id="JavaScript-2"><a href="#JavaScript-2" class="headerlink" title="JavaScript"></a>JavaScript</h2><p>JavaScriptåŒ…å«äº†ï¼šCall Stackï¼ˆå‘¼å«å †ç–Šï¼‰ã€Event Loopï¼ˆäº‹ä»¶å¾ªç’°ï¼‰ã€Callback quequ(å›èª¿ä½‡åˆ—)ï¼Œä»¥ä¸‹æœƒé€æ­¥ä»‹ç´¹ã€‚</p>
<h2 id="Call-Stackå‘¼å«å †ç–Š-2"><a href="#Call-Stackå‘¼å«å †ç–Š-2" class="headerlink" title="Call Stackå‘¼å«å †ç–Š"></a>Call Stackå‘¼å«å †ç–Š</h2><p><img src="/images/eventLoop/callstack.png"></p>
<ul>
<li>å› ç‚ºJavaScriptç‚ºå–®åŸ·è¡Œç·’çš„è¨­è¨ˆï¼Œ<strong>ä¸€æ¬¡åªèƒ½åŸ·è¡Œä¸€å€‹å‹•ä½œ</strong>ï¼Œå› æ­¤ç­‰å¾…åŸ·è¡Œçš„ä»»å‹™æœƒè¢«æ”¾å…¥Call Stackã€‚</li>
<li>æº–å‚™åŸ·è¡Œçš„ä»»å‹™æœƒåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸‹å¾€ä¸Šå †ç–Šã€‚</li>
<li>åŸ·è¡Œæ™‚ï¼Œä¹Ÿåƒç©æœ¨ä¸€æ¨£ï¼Œç”±ä¸Šå¾€ä¸‹æ‹¿å–ï¼Œä¹Ÿç¨±ç‚ºå…ˆé€²å¾Œå‡ºæ³•ï¼ˆLIFO, Last in First outï¼‰</li>
</ul>
<hr>
<p>ä½†å¦‚æœå‡ºç¾åƒSetTimeout()ã€fetch()ç­‰ç­‰é‹è¡Œæ™‚é–“è¼ƒé•·çš„å‡½æ•¸ï¼Œè©²æ€éº¼è¾¦å‘¢ï¼Ÿé€™å€‹æ™‚å€™Web APIå°±æ´¾ä¸Šç”¨å ´äº†ï¼</p>
<hr>
<h2 id="Web-APIs-1"><a href="#Web-APIs-1" class="headerlink" title="Web APIs"></a>Web APIs</h2><p><img src="/images/eventLoop/webapis.png"></p>
<ul>
<li>æ¯ç•¶å‘¼å«éåŒæ­¥å‡½æ•¸æ™‚ï¼Œå®ƒéƒ½æœƒè¢«å‚³é€åˆ°å°æ‡‰çš„ç€è¦½å™¨APIï¼Œè©²APIæœƒç­‰å¾…å®Œæˆå‡½æ•¸å»¶é²çš„æ“ä½œå¾Œå†å‚³å›é€²è¡Œè™•ç†ã€‚ </li>
<li>ä»¥setTimeout()ç‚ºä¾‹ï¼Œç•¶Call StackåŸ·è¡Œæ™‚ï¼ŒsetTimeout()æœƒè¢«å‚³é€åˆ°Web APIï¼Œç­‰å¾…æŒ‡å®šçš„æ™‚é–“å®Œæˆå†å°‡è©²æ“ä½œå‚³å›é€²è¡Œè™•ç†ã€‚</li>
</ul>
<hr>
<p>å¾Web APIç­‰æ™‚é–“è·‘å®Œå¾Œï¼Œå®ƒå°‡æ“ä½œç™¼é€åˆ°å“ªè£¡ï¼Ÿä»–å€‘è¢«ç™¼é€åˆ°<strong>äº‹ä»¶ä½‡åˆ—ï¼ˆEvent queueï¼‰</strong></p>
<hr>
<h2 id="Event-queue-äº‹ä»¶ä½‡åˆ—-1"><a href="#Event-queue-äº‹ä»¶ä½‡åˆ—-1" class="headerlink" title="Event queue äº‹ä»¶ä½‡åˆ—"></a>Event queue äº‹ä»¶ä½‡åˆ—</h2><p><img src="/images/eventLoop/eventque.png"></p>
<ul>
<li>Event queue è£¡é¢æ˜¯å¾…åŸ·è¡Œçš„ä»»å‹™ï¼Œå…¶ä¸­æ¯å€‹è¨Šæ¯éƒ½èˆ‡ä¸€å€‹ function ç›¸é—œè¯ã€‚</li>
<li>ç•¶å †ç–Šä¸­æœ‰è¶³å¤ ç©ºé–“æ™‚ï¼Œæœƒå¾Event queue äº‹ä»¶ä½‡åˆ—æ‹¿å–ä¸€å€‹ä»»å‹™é€²è¡Œè™•ç†ï¼Œè™•ç†éç¨‹åŒ…å«äº†å‘¼å«ç›¸é—œè¯çš„ functionã€‚åªæœ‰ç•¶å †ç–Šæ¸…ç©ºæ™‚ï¼Œè©²ä½‡åˆ—æ‰ç®—æ˜¯å®Œæˆè™•ç†ã€‚</li>
</ul>
<hr>
<p>ä¸Šé¢åˆ†åˆ¥ä»‹ç´¹äº†Call Stackã€Web APIsã€Event queueï¼Œæ¥ä¸‹ä¾†å¯ä»¥å°‡ä»–å€‘çµ„èµ·ä¾†äº†ï¼çµ„èµ·ä¾†å¾Œå¯ä»¥æ›´å¥½åœ°ç†è§£Event Loopã€‚</p>
<hr>
<h2 id="Event-Loop-äº‹ä»¶å¾ªç’°-1"><a href="#Event-Loop-äº‹ä»¶å¾ªç’°-1" class="headerlink" title="Event Loop äº‹ä»¶å¾ªç’°"></a>Event Loop äº‹ä»¶å¾ªç’°</h2><p><img src="/images/eventLoop/eventloop.png"></p>
<ul>
<li>Event Loop å®ƒä¸æ–·æª¢æŸ¥Call Stackå‘¼å«å †ç–Šæ˜¯å¦ç‚ºç©ºã€‚<ul>
<li>å¦‚æœç‚ºç©ºï¼šå‰‡å¾äº‹ä»¶ä½‡åˆ—Event queueä¸­æ–°å¢å‡½å¼è‡³Call Stackã€‚ </li>
<li>æ–°å¢å‡½å¼è‡³Call Stackçš„æ­¥é©Ÿï¼Œåˆç¨±ç‚ºéåŒæ­¥å›èª¿ï¼ˆasynchronous ï¼‰</li>
<li>å¦‚æœä¸ç‚ºç©ºï¼šè™•ç†Call Stackå…§çš„å‡½æ•¸ã€‚</li>
</ul>
</li>
</ul>
<h2 id="ç¯„ä¾‹ç¤ºæ„-1"><a href="#ç¯„ä¾‹ç¤ºæ„-1" class="headerlink" title="ç¯„ä¾‹ç¤ºæ„"></a>ç¯„ä¾‹ç¤ºæ„</h2><p>ç•¶ç„¶ï¼Œå¦‚æœåƒ…ä»¥ä¸Šä»‹ç´¹ï¼Œç„¡æ³•å®Œæ•´äº†è§£ï¼Œ<br>é€™ç­æº–å‚™äº†å¹¾å€‹ç¨‹å¼ç¢¼åŠæ­é…<a target="_blank" rel="noopener" href="http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4=">loupe</a>ï¼Œè®“è®€è€…èƒ½å¤ æ›´äº†è§£å…¶é‹è¡Œæ­¥é©Ÿ</p>
<p>:warning:å¯ä»¥æŒ‰æ­¤<a target="_blank" rel="noopener" href="http://latentflip.com/loupe/?code=Y29uc29sZS5sb2coIkhpIik7CnNldFRpbWVvdXQoZnVuY3Rpb24gY2IoKSB7CiAgY29uc29sZS5sb2coInRoZXJlIik7Cn0sIDUwMDApOwpjb25zb2xlLmxvZygiZW5kIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4=">loupe</a>äº†è§£JavaScripté‹è¡Œä»¥ä¸Šç¨‹å¼çš„æ­¥é©Ÿ</p>
<h3 id="ç¯„ä¾‹ç¤ºç¯„1-1"><a href="#ç¯„ä¾‹ç¤ºç¯„1-1" class="headerlink" title="ç¯„ä¾‹ç¤ºç¯„1"></a>ç¯„ä¾‹ç¤ºç¯„1</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hi&quot;</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">cb</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;there&quot;</span>);<br>&#125;, <span class="hljs-number">5000</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;end&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">Hi<br><span class="hljs-keyword">end</span><br>there<br></code></pre></td></tr></table></figure>

<h3 id="ç¯„ä¾‹ç¤ºç¯„2-5"><a href="#ç¯„ä¾‹ç¤ºç¯„2-5" class="headerlink" title="ç¯„ä¾‹ç¤ºç¯„2"></a>ç¯„ä¾‹ç¤ºç¯„2</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">foo</span>();<br>&#125;<br><br><span class="hljs-title function_">foo</span>();<br></code></pre></td></tr></table></figure>
<p>æœƒå¾—åˆ°ä»¥ä¸‹çµæœï¼š</p>
<p><img src="/images/eventLoop/pasted-0.png" alt="upload successful"></p>
<p>æ­¤åˆç¨±ç‚º<strong>å †ç–Šçˆ†ç‚¸</strong>ï¼Œç•¶ Stack ä¸æ–·å¢é•·ï¼Œç›´åˆ°ç€è¦½å™¨å…§å­˜è€—ç›¡ã€‚<br>æ˜¯ç€è¦½å™¨åœ¨å“€åšçš„è²éŸ³ğŸ˜‚ğŸ˜‚</p>
<p>ä»¥ä¸Šæ˜¯é—œæ–¼Event Loopçš„ä»‹ç´¹ï¼Œæ˜¯æˆ‘ç”±ä»¥ä¸‹åƒè€ƒè³‡æ–™æ•´ç†+è‡ªå·±ç¹ªåœ–è€Œæˆï¼Œå¦‚æœæ‚¨æœ‰èˆˆè¶£äº†è§£æ›´å¤šï¼Œè«‹åƒè€ƒï¼š</p>
<h3 id="åƒè€ƒè³‡æ–™ï¼š-4"><a href="#åƒè€ƒè³‡æ–™ï¼š-4" class="headerlink" title="åƒè€ƒè³‡æ–™ï¼š"></a>åƒè€ƒè³‡æ–™ï¼š</h3><blockquote>
<p>What the heck is the event loop anyway? | Philip Roberts<br><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=8aGhZQkoFbQ">https://www.youtube.com/watch?v=8aGhZQkoFbQ</a></p>
<p>è«‹èªªæ˜ç€è¦½å™¨ä¸­çš„äº‹ä»¶å¾ªç’° (Event Loop)<br><a target="_blank" rel="noopener" href="https://www.explainthis.io/zh-hant/swe/what-is-event-loop">https://www.explainthis.io/zh-hant/swe/what-is-event-loop</a></p>
<p>What is an event loop in JavaScript?<br><a target="_blank" rel="noopener" href="https://www.educative.io/answers/what-is-an-event-loop-in-javascript">https://www.educative.io/answers/what-is-an-event-loop-in-javascript</a></p>
</blockquote>
<!--


æ­¤åˆç¨±ç‚º**å †ç–Šçˆ†ç‚¸**ï¼Œç•¶ Stack ä¸æ–·å¢é•·ï¼Œç›´åˆ°ç€è¦½å™¨å…§å­˜è€—ç›¡ã€‚
æ˜¯ç€è¦½å™¨åœ¨å“€åšçš„è²éŸ³ğŸ˜‚ğŸ˜‚

ä»¥ä¸Šæ˜¯é—œæ–¼Event Loopçš„ä»‹ç´¹ï¼Œæ˜¯æˆ‘ç”±ä»¥ä¸‹åƒè€ƒè³‡æ–™æ•´ç†+è‡ªå·±ç¹ªåœ–è€Œæˆï¼Œå¦‚æœæ‚¨æœ‰èˆˆè¶£äº†è§£æ›´å¤šï¼Œè«‹åƒè€ƒï¼š


### åƒè€ƒè³‡æ–™ï¼š
> What the heck is the event loop anyway? | Philip Roberts
>https://www.youtube.com/watch?v=8aGhZQkoFbQ
>
> è«‹èªªæ˜ç€è¦½å™¨ä¸­çš„äº‹ä»¶å¾ªç’° (Event Loop)
> https://www.explainthis.io/zh-hant/swe/what-is-event-loop
> 
> What is an event loop in JavaScript?
> https://www.educative.io/answers/what-is-an-event-loop-in-javascript

<!--

    </div>
     
    <div class="post-footer__meta"><p>æ›´æ–°æ–¼ 2023-11-07</p></div> 
    <div class="post-entry__tags"></div> 
</article>






</main>

            <footer class="footer">
    
    


    
     
 

 
    
        
        <p class="footer-copyright">
            Copyright Â© 2023 <a href="/">Adora&#39;s Blog</a>
        </p>
    
    
    <p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme - <a href="https://github.com/ChrAlpha/hexo-theme-cards" target="_blank">Cards</a></p>
</footer>

        </div>
         

 

 

 

 



 



 


    
 

 

 

 

 

 




    </body>
</html>
